<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Honda Pioneer 1000 AR</title>
  <style>
    :not(:defined) > * { display: none; }
    html, body { width:100%; height:100%; margin:0; padding:0; }
    
    model-viewer {
      width: 100%;
      height: 90%;
      background-color: #ffffff;
    }

    /* Hotspots */
    .Hotspot {
      background: #fff;
      border-radius: 32px;
      border: 0;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.25);
      box-sizing: border-box;
      cursor: pointer;
      height: 24px;
      padding: 8px;
      position: relative;
      transition: opacity 0.3s;
      width: 24px;
    }

    .Hotspot:not([data-visible]) {
      background: transparent;
      border: 4px solid #fff;
      box-shadow: none;
      height: 32px;
      pointer-events: none;
      width: 32px;
    }

    .Hotspot:focus {
      border: 4px solid rgb(0, 128, 200);
      height: 32px;
      outline: none;
      width: 32px;
    }

    .Hotspot > * { opacity: 1; transform: translateY(-50%); }

    .HotspotAnnotation{
      background: #fff;
      border-radius: 4px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.25);
      color: rgba(0, 0, 0, 0.8);
      display: block;
      font-family: Futura, Helvetica Neue, sans-serif;
      font-size: 18px;
      font-weight: 700;
      left: calc(100% + 1em);
      max-width: 128px;
      overflow-wrap: break-word;
      padding: 0.5em 1em;
      position: absolute;
      top: 50%;
      width: max-content;
    }

    .Hotspot:not([data-visible]) > * {
      opacity: 0;
      pointer-events: none;
      transform: translateY(calc(-50% + 4px));
      transition: transform 0.3s, opacity 0.3s;
    }

    /* Progress bar */
    .progress-bar {
      display: block;
      width: 33%;
      height: 10%;
      max-height: 2%;
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate3d(-50%, -50%, 0);
      border-radius: 25px;
      box-shadow: 0px 3px 10px 3px rgba(0,0,0,0.5), 0px 0px 5px 1px rgba(0,0,0,0.6);
      border: 1px solid rgba(255,255,255,0.9);
      background-color: rgba(0,0,0,0.5);
    }
    .progress-bar.hide { visibility: hidden; transition: visibility 0.3s; }
    .update-bar { background-color: rgba(255,255,255,0.9); width:0%; height:100%; border-radius:25px; float:left; transition: width 0.3s; }

    /* AR button */
    #ar-button {
      background-image: url(ar_icon.png);
      background-repeat: no-repeat;
      background-size: 20px 20px;
      background-position: 12px 50%;
      background-color: #fff;
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      white-space: nowrap;
      bottom: 16px;
      padding: 0px 16px 0px 40px;
      font-family: Roboto Regular, Helvetica Neue, sans-serif;
      font-size: 14px;
      color:#4285f4;
      height: 36px;
      line-height: 36px;
      border-radius: 18px;
      border: 1px solid #DADCE0;
    }
    #ar-button:active { background-color: #E8EAED; }
    #ar-button:focus { outline:none; }
    #ar-button:focus-visible { outline: 1px solid #4285f4; }

    /* AR hand animations */
    @keyframes circle { from { transform: translateX(-50%) rotate(0deg) translateX(50px) rotate(0deg); } to { transform: translateX(-50%) rotate(360deg) translateX(50px) rotate(-360deg); } }
    @keyframes elongate { from { transform: translateX(100px); } to { transform: translateX(-100px); } }
    model-viewer > #ar-prompt {
      position: absolute;
      left: 50%;
      bottom: 60px;
      animation: elongate 2s infinite ease-in-out alternate;
      display: none;
    }
    model-viewer[ar-status="session-started"] > #ar-prompt { display: block; }
    model-viewer > #ar-prompt > img { animation: circle 4s linear infinite; }
  </style>
</head>
<body>
  <model-viewer
    src="Pioneer 1000 10.25.glb"
    ios-src="Pioneer1000.usdz"
    ar
    ar-modes="webxr scene-viewer quick-look"
    camera-controls
    tone-mapping="neutral"
    poster="poster.png"
    shadow-intensity="2"
    exposure="0.95"
    shadow-softness="1"
    environment-image="legacy">

    <!-- Hotspots -->
    <button class="Hotspot" slot="hotspot-2" data-position="-0.3404m 0.5778m 0.1535m">
      <div class="HotspotAnnotation">INSTRUMENT PANEL & CONTROLS</div>
    </button>
    <button class="Hotspot" slot="hotspot-5" data-position="0.8339m 0.5630m 0.4407m">
      <div class="HotspotAnnotation">BED LIGHT</div>
    </button>
    <button class="Hotspot" slot="hotspot-6" data-position="0.2437m 0.8385m 0.4620m">
      <div class="HotspotAnnotation">REAR SLIDING WINDOW</div>
    </button>
    <button class="Hotspot" slot="hotspot-8" data-position="-0.0839m 0.4331m -0.2068m">
      <div class="HotspotAnnotation">UNDER SEAT STORAGE</div>
    </button>
    <button class="Hotspot" slot="hotspot-9" data-position="-0.7972m 0.5656m 0.0276m">
      <div class="HotspotAnnotation">FUSE BOX</div>
    </button>
    <button class="Hotspot" slot="hotspot-10" data-position="-0.6422m 0.2663m 0.0961m">
      <div class="HotspotAnnotation">DUAL-CLUTCH TRANSMISSION</div>
    </button>
    <button class="Hotspot" slot="hotspot-11" data-position="-0.3149m 0.9850m -0.4154m">
      <div class="HotspotAnnotation">GREEN GLASS WINDSHIELD</div>
    </button>

    <!-- Progress bar -->
    <div class="progress-bar" slot="progress-bar">
      <div class="update-bar"></div>
    </div>

    <!-- AR Button -->
    <button slot="ar-button" id="ar-button">View in your space</button>

    <!-- AR hand icon -->
    <div id="ar-prompt">
      <img src="ar_hand_prompt.png" width="64" height="64" alt="AR Hand Prompt">
    </div>

  </model-viewer>

  <!-- QR Popup Overlay -->
  <div id="qr-overlay" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.6);justify-content:center;align-items:center;z-index:20;">
    <img id="qr-popup" src="qrCode.png" alt="QR Code" style="max-width:80vw;max-height:80vh;border-radius:8px;">
  </div>

  <script>
    const modelViewer = document.querySelector('model-viewer');
    const arPrompt = document.getElementById('ar-prompt');
    const qrOverlay = document.getElementById('qr-overlay');

    // Hotspot click
    document.querySelectorAll('.Hotspot').forEach(btn => {
      btn.addEventListener('click', () => {
        window.open('https://powersports.honda.com/sxs/recutility/pioneer-1000', '_blank');
      });
    });

    // Keep hotspots visible in AR
    modelViewer.addEventListener('ar-status', (event) => {
      if (event.detail.status === 'session-started') {
        document.querySelectorAll('.Hotspot').forEach(h => h.style.display = 'block');
      }
    });

    // QR popup logic
    arPrompt.addEventListener('click', () => { qrOverlay.style.display = 'flex'; });
    qrOverlay.addEventListener('click', () => { qrOverlay.style.display = 'none'; });

    // Progress bar handling
    const onProgress = (event) => {
      const progressBar = event.target.querySelector('.progress-bar');
      const updatingBar = event.target.querySelector('.update-bar');
      updatingBar.style.width = `${event.detail.totalProgress * 100}%`;
      if (event.detail.totalProgress === 1) {
        progressBar.classList.add('hide');
        event.target.removeEventListener('progress', onProgress);
      } else {
        progressBar.classList.remove('hide');
      }
    };
    modelViewer.addEventListener('progress', onProgress);
  </script>

  <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/4.0.0/model-viewer.min.js"></script>
</body>
</html>
