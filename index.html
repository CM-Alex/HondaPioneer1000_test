<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Model Viewer â€” AR button fix</title>

  <style>
    html,body { height:100%; margin:0; }
    model-viewer { width:100vw; height:100vh; display:block; background:#000; }
    .Hotspot {
      background:#fff; border-radius:50%; width:24px; height:24px;
      position:absolute; transform:translate(-50%,-50%); box-shadow:0 2px 6px rgba(0,0,0,.25);
      border:none; cursor:pointer;
    }
    .HotspotAnnotation { display:none; } /* keep simple for now */
  </style>

  <!-- load model-viewer early so the element exists before we reference it -->
  <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/4.0.0/model-viewer.min.js"></script>
</head>
<body>
  <!--
    IMPORTANT:
    - Replace the src and ios-src filenames with the exact filenames you host.
    - Page must be served over HTTPS (or localhost) for AR to work on mobile.
  -->
  <model-viewer
    src="Pioneer1000.glb"
    ios-src="Pioneer1000.usdz"
    ar
    ar-modes="scene-viewer quick-look webxr"
    camera-controls
    environment-image="neutral"
    exposure="1"
    shadow-intensity="1">

    <!-- Hotspots (visible in the 3D browser view) -->
    <button class="Hotspot" slot="hotspot-2" data-position="-0.3404m 0.5778m 0.1535m" aria-label="Instrument Panel"></button>
    <button class="Hotspot" slot="hotspot-5" data-position="0.8339m 0.5630m 0.4407m" aria-label="Bed Light"></button>

    <!-- Use the default model-viewer AR button slot -->
    <button slot="ar-button">View in your space</button>
  </model-viewer>

  <script>
    // Basic runtime checks to help debug why AR button may not show:
    const mv = document.querySelector('model-viewer');

    // Log support info; open console on device to inspect if button missing.
    (async () => {
      console.log('model-viewer ready', mv);
      try {
        const webxrSupported = await navigator.xr?.isSessionSupported?.('immersive-ar');
        console.log('WebXR immersive-ar supported:', !!webxrSupported);
      } catch(e){ console.log('WebXR check error', e); }

      // Quick visibility helpers: if page served insecurely, AR won't work.
      if (location.protocol !== 'https:' && location.hostname !== 'localhost') {
        console.warn('AR requires HTTPS or localhost. Serving over:', location.protocol);
      }
    })();

    // Optional: simple click handlers for hotspots (open product page)
    document.querySelectorAll('.Hotspot').forEach(h => {
      h.addEventListener('click', () => {
        window.open('https://powersports.honda.com/sxs/recutility/pioneer-1000', '_blank', 'noopener');
      });
    });
  </script>
</body>
</html>
